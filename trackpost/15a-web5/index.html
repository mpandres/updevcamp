<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"><head><link href="http://gmpg.org/xfn/11" rel="profile"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><title>MVC</title><link rel="stylesheet" href="/css/main.css"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png"><link href="/favicon.png" rel="icon"><link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'><link href="http://fonts.googleapis.com/css?family=Roboto+Slab:300" rel="stylesheet" type="text/css"><link href="" rel="alternate" type="application/rss+xml" title="UP CSI Devcamp &middot; "/><meta name="description" content="CSI Devcamp provides a space and network for motivated students to learn and create awesome stuff"><meta name="keywords" content="Devcamp, UP, CSI, Computer, Science, UP CSI Devcamp, Bootcamp, Mentorship, Mentor, Mentee"> </head><body> <header><h1><a href="/"><span class="color-csi">UP CSI</span> Devcamp</a></h1><nav><ul><li> <a href="/resources">Resources</a></li><li> <a href="/tracks">Tracks</a></li></ul></nav></header><div class="main-wrapper">   <div class="content container"><article class="post"> <h1 class="post-title"> <a href="/tracks/web">Web</a> Track: MVC</h1> <span class="post-by"> by: <span class="author-name"><a class="label" href="/authors/arian">Arian Allenson M. Valdez</a></span> </span> <h1>Table of Contents</h1><div class="toc"> <nav id="TableOfContents">
<ul>
<li><a href="#mvc:8e3508e56efa81a39292041a2796a89d">MVC</a>
<ul>
<li><a href="#mvc-2:8e3508e56efa81a39292041a2796a89d">MVC-2</a></li>
<li><a href="#mvc-3:8e3508e56efa81a39292041a2796a89d">MVC-3</a></li>
<li><a href="#mvc-4:8e3508e56efa81a39292041a2796a89d">MVC-4</a></li>
<li><a href="#mvc-5:8e3508e56efa81a39292041a2796a89d">MVC 5</a></li>
</ul></li>
<li><a href="#mvc-1:8e3508e56efa81a39292041a2796a89d">MVC</a></li>
</ul>
</nav></div>  

<h1 id="mvc:8e3508e56efa81a39292041a2796a89d">MVC</h1>

<p>On our last file <code>crs3.py</code>, we&rsquo;ve mingled our logic with our html page. While this may seem fine at the start, this is going to be very hard to maintain later. Let&rsquo;s do a little better in design by using mvc.</p>

<p>Open up <code>lectures/simple/index.py</code></p>

<p>
<figure >
    
        <img src="/media/tracks/web/simple.png" />
    
    
</figure>
</p>

<p>It&rsquo;s a very simple webpage, that looks like the first version of the updevcampwebsite! We can visit the different tracks and resources via hyperlinks.</p>

<p>Try clicking a few links and playing around with it. It&rsquo;s just a very simple website that links to different pages.</p>

<p>If you take a look at how it&rsquo;s implemented, you&rsquo;ll see that the different pages have different files for each of them. Let&rsquo;s take a look at <code>index.py</code>:</p>

<pre><code class="language-python">#!/usr/local/bin/python3
import cgi
print(&quot;Content-type: text/html&quot;)

print('''
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;UP DevCamp&lt;/title&gt;
&lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;UP DevCamp&lt;/h1&gt;
        &lt;ul&gt;&lt;a href=&quot;tracks.py&quot;&gt;Tracks&lt;/ul&gt;
        &lt;ul&gt;&lt;a href=&quot;resources.py&quot;&gt;Resources&lt;/ul&gt;
    &lt;/body&gt;
&lt;/html&gt;
''')
</code></pre>

<p>Inside, it looks like we&rsquo;re just printing the index HTML page.</p>

<p>If we take a look at <code>tracks.py</code> you&rsquo;ll notice that it&rsquo;s just printing the HTML page as well:</p>

<pre><code class="language-python">#!/usr/local/bin/python3
import cgi
print(&quot;Content-type: text/html&quot;)

print('''
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Tracks&lt;/title&gt;
&lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Tracks&lt;/h1&gt;
        &lt;ul&gt;&lt;a href=&quot;web.py&quot;&gt;Web&lt;/ul&gt;
    &lt;/body&gt;
&lt;/html&gt;
''')
</code></pre>

<p>If you take a look at the other files, you&rsquo;ll note that it follows the same pattern. Note how the only thing that&rsquo;s changing is the <code>ul</code> links in the pages - lines 6-11, and 15-16 are just the same - opening HTML/body tags, the head and closing HTML/body tags. While this lines are not hcanging, we have to manually type these for every single page, typing the same thing over and over again.</p>

<p>According to Larry Wall, the first of the <a href="http://threevirtues.com/">three great virtues</a> of a programmer is <strong>Laziness</strong>. Since we&rsquo;re lazy, there should be a much better way to do this so that we can reduce the repetitive lines and extract the tags that is similar on all pages.</p>

<p>Now let&rsquo;s take a look at <code>/mvc/index.py</code>:</p>

<pre><code class="language-python">#!/usr/local/bin/python3
import cgi
print(&quot;Content-type: text/html&quot;)

import header

print('''
    &lt;h1&gt;UP DevCamp&lt;/h1&gt;
    &lt;ul&gt;&lt;a href=&quot;tracks.py&quot;&gt;Tracks&lt;/ul&gt;
    &lt;ul&gt;&lt;a href=&quot;resources.py&quot;&gt;Resources&lt;/ul&gt;
''')

import footer
</code></pre>

<p>It&rsquo;s not as straightforward as before, in that we don&rsquo;t just print one big html page, but note that all that&rsquo;s different is that we&rsquo;ve replace the repeated lines with <code>import header</code> and <code>import footer</code>. We know that <code>require</code> is like <code>include</code> in C, which &lsquo;copy-pastes&rsquo; the file in that location. If we take a look at header.py, we&rsquo;ll notice that it indeed contains the header of the page:</p>

<pre><code class="language-python">print('''
&lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;CSI CGI&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
''')
</code></pre>

<p>And the footer, contains the footer/bottom of the page:</p>

<pre><code class="language-python">print('''
    &lt;/body&gt;
&lt;/html&gt;
''')
</code></pre>

<p>We have now isolated the parts that are changing, by extracting the common lines out. Note that this makes our code more maintainable. If say, we wanted to add a copyright notice at our footer, we would only need to edit one file (footer.py). Imagine if we did not extract it like so - we would have to edit every single HTML page we had with the new copyright notice!</p>

<h2 id="mvc-2:8e3508e56efa81a39292041a2796a89d">MVC-2</h2>

<p>We can do even better than this. Open up <code>mvc-2/</code>, and you&rsquo;ll notice a new file, <code>helpers.py</code>. Before taking a look at it, let&rsquo;s look at <code>index.py</code> first:</p>

<pre><code class="language-python">#!/usr/local/bin/python3
import cgi
print(&quot;Content-type: text/html&quot;)

import helpers

print(helpers.renderHeader({'title': &quot;UP DevCamp&quot;}))

print('''
    &lt;ul&gt;&lt;a href=&quot;tracks.py&quot;&gt;Tracks&lt;/ul&gt;
    &lt;ul&gt;&lt;a href=&quot;resources.py&quot;&gt;Resources&lt;/ul&gt;
''')

print(helpers.renderFooter())
</code></pre>

<p>Now we&rsquo;re not requiring <code>header</code> and <code>footer</code>, but we required a new file <code>helpers</code>. It seems that we&rsquo;re printing the return value of the function from helpers - <code>helpers.renderHeader</code>, while also passing, inside its parenthesis, curly braces that represent a dictionary. In python, we can pass values by key value-pairs wrapped in curly braces. In this case, <code>title</code> is our key and <code>UP DevCamp</code> is our value.</p>

<p>Notice also that our middle print function doesn&rsquo;t print the <code>&lt;h1&gt;UP DevCamp&lt;/h1&gt;</code> title anymore, like we did in the previous example.</p>

<p>Let&rsquo;s take a look at <code>helpers.py</code> to understand how the function works:</p>

<pre><code class="language-python">import header
import footer

def renderHeader(data):
    return header.render(data)

def renderFooter():
    return footer.render()
</code></pre>

<p>So it looks like our render function just calls render of our specific files (header, footer), while in header, we are also passing <code>data</code>. Let&rsquo;s take a look at <code>header.py</code> to see how it gets handled:</p>

<pre><code class="language-python">def render(data):
    return '''
            &lt;html&gt;
                &lt;head&gt;
                  &lt;title&gt;''' + data.get('title') + '''&lt;/title&gt;
                &lt;/head&gt;
                &lt;body&gt;
                    &lt;h1&gt;''' + data.get('title') + '''&lt;/h1&gt;
            '''
</code></pre>

<p>So it looks like it&rsquo;s the same header file, but instead of harcoding the title, it&rsquo;s now actively using the data variable. Indeed, it seems that we&rsquo;re using <code>get</code> to use the value from our key-value pair that we passed a while ago. This simplifies our code much more heavily, as it allows us to use variables on our page.</p>

<h2 id="mvc-3:8e3508e56efa81a39292041a2796a89d">MVC-3</h2>

<p>Let&rsquo;s open <code>mvc-3/index.py</code> which has an even more simplified <code>render</code> function.</p>

<pre><code class="language-python">#!/usr/local/bin/python3
import cgi
print(&quot;Content-type: text/html&quot;)

import helpers

print(helpers.render('header', {'title': &quot;UP DevCamp&quot;}))

print('''
    &lt;ul&gt;&lt;a href=&quot;tracks.py&quot;&gt;Tracks&lt;/ul&gt;
    &lt;ul&gt;&lt;a href=&quot;resources.py&quot;&gt;Resources&lt;/ul&gt;
''')

print(helpers.render('footer'))
</code></pre>

<p><code>renderHeader</code> and <code>renderFooter</code> were almost identical functions, and it would be better to just combine them. Note that instead of calling <code>renderHeader</code> and <code>renderFooter</code> explicitly, we are now just passing the template name in <code>render</code>.</p>

<p><code>helpers.py</code> looks like this now:</p>

<pre><code class="language-python">import imp
import os

def render(template, data=None):
    filePath = os.path.join(os.path.dirname(__file__), template + '.py')
    l = imp.load_source(template, filePath)
    return l.render(data)
</code></pre>

<p>It looks rather complex, but it actually works the same way. Note how we&rsquo;re calling <code>l.render(data)</code> at the end, which seem to imply <code>l</code> is just our template file (like <code>header</code> or <code>footer</code>). Indeed, the first two lines of our render function just gets the file that we are asking for.</p>

<ul>
<li>On our function definition, we use two parameters, <code>(template, data=None)</code>. Note that we&rsquo;ve set a None value to our second parameter data. Turns out python supports <code>optional</code> arguments, allowing us to set a default value if no parameter is sent. Since not all templates would need a data variable (like our footer), we set the render helper function with  <code>data=None</code> as default.</li>
<li><code>filePath</code> is the path of our file, obtained by joining <code>os.path.join</code> our current directory <code>os.path.dirname(__file__)</code> and the template name <code>template</code> with a <code>.py</code> extension</li>
<li><code>l</code> is the library we import using <code>imp.load_source</code></li>
</ul>

<h2 id="mvc-4:8e3508e56efa81a39292041a2796a89d">MVC-4</h2>

<p><code>mvc-4/index.py</code> is even much fancier, with the helpers and templates in their own directories.</p>

<p>
<figure >
    
        <img src="/media/tracks/web/mvc-4.png" />
    
    
</figure>
</p>

<pre><code class="language-python">#!/usr/local/bin/python3
import cgi
print(&quot;Content-type: text/html&quot;)

from lib import helpers

print(helpers.render('header', {'title': &quot;UP DevCamp&quot;}))

print(helpers.render('home'))

print(helpers.render('footer'))
</code></pre>

<p>Indeed, notice how we are now importing helpers <code>from lib</code> since our helpers is now in its own <code>lib</code> folder.</p>

<p>We&rsquo;ve moved <code>header</code> and <code>footer</code> in it&rsquo;s own <code>templates</code> folder, which is a much better design. We are now factoring our code as much as we can.</p>

<p>
<figure >
    
        <img src="/media/tracks/web/mvc-4-templates.png" />
    
    
</figure>
</p>

<h2 id="mvc-5:8e3508e56efa81a39292041a2796a89d">MVC 5</h2>

<p>In <code>mvc-5/</code> we take this to its conclusion by moving the actual pages to its own <code>public</code> folder.</p>

<p>
<figure >
    
        <img src="/media/tracks/web/mvc-5.png" />
    
    
</figure>
</p>

<p>We&rsquo;ve structured the site like this to organize it better. We now instantly know where our templates are, as well as the pages (public), and the helper utility functions.</p>

<p>Indeed, you&rsquo;ll note that this file pattern is incredibly common in web development.</p>

<h1 id="mvc-1:8e3508e56efa81a39292041a2796a89d">MVC</h1>

<p>Let&rsquo;s end this section by introducing MVC:</p>

<p>
<figure >
    
        <img src="/media/tracks/web/mvc.png" />
    
    
</figure>
</p>

<p>We&rsquo;ll put our programming logic, into files we call <strong>&lsquo;controllers&rsquo;</strong>. Then we&rsquo;ll have views, like templates, that takes data and presents it to the user. Finally, we have <strong>model</strong>, our database where we can store and retrieve data from.</p>
</article></div> </div><footer><p>Made with <span class="color-pink">Love</span> &copy; UP CSI</p></footer> <script src="/js/vendor.bundle.js"></script><script src="/js/main.bundle.js"></script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', "UA-69207349-1", 'auto');
  ga('send', 'pageview');
</script> </body></html>